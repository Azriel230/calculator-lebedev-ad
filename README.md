# calculator-lebedev-ad

### О проекте
Этот проект представляет собой консольное приложение — Калькулятор.
Требования к программе:
- Ввод данных осуществляется через стандартный ввод данных (stdin).
- Вывод осуществляется через стандартный вывод данных (stdout).
- Объем входных данных составляет менее 1 Кбайт (иначе UB).
- Окончание ввода определяется после считывания EOF.
- Разрешена только кодировка [0-9()*+\/\s-] (в противном случае возвращаемый код программы не равен 0).
- 0-9 соответствует одному символу в диапазоне от 0 (индекс 48) до 9 (индекс 57) (с учетом регистра).
- ()\*+ соответствует одному символу в списке ()\*+ (с учетом регистра).
- \/ соответствует символу / с индексом (или) буквально (с учетом регистра) \s соответствует любому символу пробела (эквивалентно [ \r\n\t\f\v ]).
- \- соответствует символу - с индексом (или) буквально (с учетом регистра).
- Допустимы только правильные арифметические выражения (в противном случае возвращаемый код не равен 0).
- Все числа в данном выражении являются целыми числами из диапазона $[0 \dots 2 \times 10^9]$ (в противном случае UB).
- Все промежуточные результаты (для любого допустимого порядка вычисления) укладываются в диапазон $[-2 \times 10^9 \dots +2 \times 10^9]$ (иначе UB).
- Должен поддерживаться флаг --float, который переводит вычисления приложения в режим вещественных чисел, точность которых до 4 знаков после запятой $(10^{-4}).$

### Сборка и запуск программы
Чтобы собрать программу, вам нужен компилятор `gcc` или `clang`. Следуйте этим шагам:
1. Откройте терминал в папке с проектом.
2. Напишите и запустите команду:
```bash
make all
```
Чтобы запустить программу в режиме целых чисел, введите в терминал команду:
```bash
make run-int
```
Чтобы запустить программу в режиме вещественных чисел, введите в терминал команду:
```bash
make run-float
```
### Как это работает?

Для переключения режимов используется глобальный флаг flag_float. 0 — целые числа, 1 — вещественные числа.
Для разделения типов long (целые) и double (дробные) используется объединение Number.
Для вычислений используется структура Stack. В ней содержится массив данных data с достаточно большим размером STACK_SIZE, и переменная top, указывающая на вершину стека.
Для работы со стеком были написаны следующие функции:
- initializeStack — инициализирует стек.
- isEmptyStack и isFullStack — проверяют стек на пустоту и заполненность.
- pushStack — кладет элемент в стек.
- popStack — вытаскивает верхний элемент стека и возвращает его.
- peekStack — возвращает верхний элемент стека, но не удаляет его.
Для проверки корректности требований к программе Калькулятор были написаны функции:
- checkNumberSize — проверяет, что число находится в диапазоне $[-2 \times 10^9 \dots +2 \times 10^9]$.
- validateInput — парсер входного выражения, проверяющий его корректность.
Для вычисления выражения были написаны функции:
- priorityOperations — возвращает номер операции (ее приоритет).
- applyOperation — на вход получает два числа и код операции, а возвращает результат вычисления (исключая деление на 0)
- calculatingExpression — главная функция, которая вычисляет выражение. Создается два стека: для чисел и операций, далее происходит парсинг выражения: числа и операции попадают в стек. Если есть закрывающаяся скобка, то производятся вычисления выражения до тех пор, пока из стека операций не достанем открывающуюся скобку. В конце вычисляется выражение и возвращается его значение.

В функции main считываем флаг --float, выставляем значение флага flag_float, проверяется корректность выражения и производится его вычисление. В конце оно выводится в stdout.
